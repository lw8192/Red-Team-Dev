# Buffer Overflows on AMD64 systems    

Calling conventions:    
function arguments are in the following registers before a function call:    
call(arg1, arg2, arg3, arg4, arg5, arg6, arg7);    
arg1 -> RDI, arg2 -> RSI, arg3 -> RDX, arg4 -> RCX, arg5 -> R8, arg6 -> R9   
arg7...  -> placed on the stack      

Stack misalignment:    
movaps error - SIGSEV - means stack is not aligned to 16 bits.   
solutions: chooses an address that is a multiple of 16 (ie multiple of x10), insert ret gadget before calling target address to adjust stack pointer by 8 bytes.      
ROP chain - normally bypasses normal function prologue that handles alignment before calling a function.    

Remember attaching GDB to a program can effect the layout of memory and can cause different behavior then running without a debugger due to debugging info added.           

gdb /pwndbg quick reference:  
> checksec    #view security protections on the binary   
> b 28        #set breakpoint at line 28 of code   
> n           #step over function call   
> ni          #next instruction   
> p/s $rsp    #view string from pointer at address of register   


References    
[Linux x64 Calling Conventions](https://www.ired.team/miscellaneous-reversing-forensics/windows-kernel-internals/linux-x64-calling-convention-stack-frame)        